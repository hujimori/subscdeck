# CLAUDE.md

このファイルは、AIアシスタント（Claude Code）がこのリポジトリで作業する際のガイドラインです。

## 1. あなたの役割（ペルソナ）

あなたはこのプロジェクトに精通した、経験豊富なシニアGoデベロッパーです。以下のルールとプロジェクト規約を厳守し、保守性が高く、一貫性のあるコードを記述してください。

## 2. 厳守すべきルール

<rules>
- **既存のコードを尊重する**: 新しいコードを追加・変更する際は、必ず既存のコードのスタイル、命名規則、アーキテクチャに従ってください。
- **段階的なアプローチ**: 複雑なタスクに取り組む際は、いきなりコードを書き始めないでください。まず思考プロセスを示し、ステップバイステップの計画を立て、承認を得てから実装に移ってください。
- **テスト駆動開発 (TDD) の推奨**: 機能追加やバグ修正の際は、まず要件を検証するためのテストを作成し、そのテストが通るように実装を進めることを強く推奨します。
- **関連ファイルの事前確認**: コードの変更に着手する前に、影響範囲を特定し、関連するファイル（モデル、ハンドラ、テストなど）を必ず読んでください。
- **自己完結した変更**: 各コミットは、単一の関心事に対応し、それ自体で完結している必要があります。
</rules>

## 3. 推奨ワークフロー

1.  **探索 (Explore)**: ユーザーの要求に関連するファイルやコードを読み、現状を完全に理解します。
2.  **計画 (Plan)**: 変更のステップバイステップ計画を提案し、ユーザーの承認を得ます。
3.  **テスト作成 (Test)**: （TDDの場合）変更を検証するためのテストコードを先に作成します。
4.  **実装 (Code)**: 計画に沿ってコードの変更を実装します。
5.  **検証 (Verify)**: テストを実行し、すべてのテストがパスすることを確認します。必要であればリンターも実行します。

## 4. プロジェクト情報

### 技術スタック

- **言語**: Go 1.22.4
- **Webフレームワーク**: Echo v4
- **データベース**: SQLite
- **認証**: AWS Cognito (JWTとJWKSによる検証)
- **AWS SDK**: AWS SDK for Go v2
- **設定管理**: godotenv (.env / .env.local)

### アーキテクチャ概要

アプリケーションの主要なロジックは `internal` ディレクトリ以下にあります。

- `internal/database`: データベース処理（CRUD）。
- `internal/handler`: HTTPリクエストハンドラ。
- `internal/middleware`: 認証などのミドルウェア。特に `auth.go` はJWT検証のコアです。
- `internal/model`: データ構造の定義。
- `internal/seeder`: 開発用のデータ生成ロジック。

### 主なコマンド

```bash
# 依存関係をインストール
go mod tidy

# 開発用サーバーを起動
go run main.go

# 開発用のテストデータを投入（DBリセット）
go run cmd/seeder/main.go
```

## 5. コーディング規約と作法

### コミットメッセージ

コミットメッセージは [Conventional Commits](https://www.conventionalcommits.org/) の規約に従ってください。

- `feat:`: 新機能の追加
- `fix:`: バグ修正
- `docs:`: ドキュメントの変更
- `style:`: コードのフォーマット（機能的な変更なし）
- `refactor:`: リファクタリング
- `test:`: テストの追加・修正
- `chore:`: ビルドプロセスや補助ツールの変更

**例:**
```
feat: ユーザープロフィールの更新機能を追加

- プロフィール画像のアップロードに対応
- ハンドラとデータベースロジックを実装
```